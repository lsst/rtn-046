%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Document:      DM  operations product tree
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass{article}
\usepackage{times,layouts}
\usepackage{tikz,hyperref,amsmath}
\usetikzlibrary{positioning,arrows,shapes,decorations.shapes,shapes.arrows}
\usetikzlibrary{backgrounds,calc}
\usepackage[paperwidth=20.8cm,paperheight=47.300000000000004cm,
left=-2mm,top=3mm,bottom=0mm,right=0mm,
noheadfoot,marginparwidth=0pt,includemp=false,
textwidth=30cm,textheight=50mm]{geometry}
\newcommand\showpage{%
\setlayoutscale{0.5}\setlabelfont{\tiny}\printheadingsfalse\printparametersfalse
\currentpage\pagedesign}
\hypersetup{pdftitle={DM products }, pdfsubject={Diagram illustrating the
products in LSST DM }, pdfauthor={ William O'Mullane}}
\tikzstyle{tbox}=[rectangle,text centered, text width=30mm]
\tikzstyle{wbbox}=[rectangle, rounded corners=3pt, draw=black, top color=blue!50!white, bottom color=white, very thick, minimum height=12mm, inner sep=2pt, text centered, text width=30mm]
\tikzstyle{pbox}=[rectangle, rounded corners=3pt, draw=black, top color=yellow!50!white, bottom color=white, very thick, minimum height=35pt, inner sep=2pt, text centered, text width=35mm]
\tikzstyle{pline}=[-, thick]
\begin{document}
\begin{tikzpicture}[node distance=0mm]
\node (0-DM) [wbbox]{\textbf{DM Ops}};
\node (1-DA) [pbox,right=15mm of 0-DM] {\textbf{Data Abstraction} };
\node [below right] at (1-DA.north west) {\small \color{blue}Team} ;
 \draw[pline] (0-DM.east) -| ++(0.4,0) |- (1-DA.west); 
\node (2-DataEng) [pbox,right=15mm of 1-DA] {\textbf{Data Engineering} };
\node [below right] at (2-DataEng.north west) {\small \color{blue}Activity} ;
 \draw[pline] (1-DA.east) -| ++(0.4,0) |- (2-DataEng.west); 
\node (3-felis) [pbox,right=15mm of 2-DataEng] {\textbf{Felis} };
\node [below right] at (3-felis.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-DataEng.east) -| ++(0.4,0) |- (3-felis.west); 
\node (3-meta) [pbox,below=4pt of 3-felis] {\textbf{Metadata} };
\node [below right] at (3-meta.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-DataEng.east) -| ++(0.4,0) |- (3-meta.west); 
\node (2-Middle) [pbox,below=45pt of 2-DataEng] {\textbf{Middleware} };
\node [below right] at (2-Middle.north west) {\small \color{blue}Activity} ;
 \draw[pline] (1-DA.east) -| ++(0.4,0) |- (2-Middle.west); 
\node (3-bps) [pbox,right=15mm of 2-Middle] {\textbf{BPS} };
\node [below right] at (3-bps.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-Middle.east) -| ++(0.4,0) |- (3-bps.west); 
\node (3-butler) [pbox,below=4pt of 3-bps] {\textbf{Butler} };
\node [below right] at (3-butler.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-Middle.east) -| ++(0.4,0) |- (3-butler.west); 
\node (3-ctrl) [pbox,below=4pt of 3-butler] {\textbf{Control Interface} };
\node [below right] at (3-ctrl.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-Middle.east) -| ++(0.4,0) |- (3-ctrl.west); 
\node (3-spinter) [pbox,below=4pt of 3-ctrl] {\textbf{Pipeline interfaces} };
\node [below right] at (3-spinter.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-Middle.east) -| ++(0.4,0) |- (3-spinter.west); 
\node (2-SingleExec) [pbox,below=127pt of 2-Middle] {\textbf{Single-site Exec} };
\node [below right] at (2-SingleExec.north west) {\small \color{blue}Product} ;
 \draw[pline] (1-DA.east) -| ++(0.4,0) |- (2-SingleExec.west); 
\node (3-ocps) [pbox,right=15mm of 2-SingleExec] {\textbf{OCPS} };
\node [below right] at (3-ocps.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-SingleExec.east) -| ++(0.4,0) |- (3-ocps.west); 
\node (3-prompt) [pbox,below=4pt of 3-ocps] {\textbf{Prompt f/ w} };
\node [below right] at (3-prompt.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-SingleExec.east) -| ++(0.4,0) |- (3-prompt.west); 
\node (1-DF) [pbox,below=291pt of 1-DA] {\textbf{Data Facilities} };
\node [below right] at (1-DF.north west) {\small \color{blue}Group} ;
 \draw[pline] (0-DM.east) -| ++(0.4,0) |- (1-DF.west); 
\node (2-Curation) [pbox,right=15mm of 1-DF] {\textbf{Data Curation} };
\node [below right] at (2-Curation.north west) {\small \color{blue}Team} ;
 \draw[pline] (1-DF.east) -| ++(0.4,0) |- (2-Curation.west); 
\node (3-Backbone) [pbox,right=15mm of 2-Curation] {\textbf{Data Backbone} };
\node [below right] at (3-Backbone.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-Curation.east) -| ++(0.4,0) |- (3-Backbone.west); 
\node (3-Backups) [pbox,below=4pt of 3-Backbone] {\textbf{Backups} };
\node [below right] at (3-Backups.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-Curation.east) -| ++(0.4,0) |- (3-Backups.west); 
\node (3-Bulk) [pbox,below=4pt of 3-Backups] {\textbf{Bulk Download} };
\node [below right] at (3-Bulk.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-Curation.east) -| ++(0.4,0) |- (3-Bulk.west); 
\node (3-Consol) [pbox,below=4pt of 3-Bulk] {\textbf{Consolidated DB} };
\node [below right] at (3-Consol.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-Curation.east) -| ++(0.4,0) |- (3-Consol.west); 
\node (3-Repos) [pbox,below=4pt of 3-Consol] {\textbf{Butler repos} };
\node [below right] at (3-Repos.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-Curation.east) -| ++(0.4,0) |- (3-Repos.west); 
\node (3-Rucio) [pbox,below=4pt of 3-Repos] {\textbf{Rucio} };
\node [below right] at (3-Rucio.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-Curation.east) -| ++(0.4,0) |- (3-Rucio.west); 
\node (2-Infra) [pbox,below=209pt of 2-Curation] {\textbf{Infrastructures} };
\node [below right] at (2-Infra.north west) {\small \color{blue}Group} ;
 \draw[pline] (1-DF.east) -| ++(0.4,0) |- (2-Infra.west); 
\node (3-cdf) [pbox,right=15mm of 2-Infra] {\textbf{CDF} };
\node [below right] at (3-cdf.north west) {\small \color{blue}Team} ;
 \draw[pline] (2-Infra.east) -| ++(0.4,0) |- (3-cdf.west); 
\node (3-frdf) [pbox,below=4pt of 3-cdf] {\textbf{FRDF} };
\node [below right] at (3-frdf.north west) {\small \color{blue}Team} ;
 \draw[pline] (2-Infra.east) -| ++(0.4,0) |- (3-frdf.west); 
\node (3-tdf) [pbox,below=4pt of 3-frdf] {\textbf{TDF} };
\node [below right] at (3-tdf.north west) {\small \color{blue}Team} ;
 \draw[pline] (2-Infra.east) -| ++(0.4,0) |- (3-tdf.west); 
\node (3-ukdf) [pbox,below=4pt of 3-tdf] {\textbf{UKDF} };
\node [below right] at (3-ukdf.north west) {\small \color{blue}Team} ;
 \draw[pline] (2-Infra.east) -| ++(0.4,0) |- (3-ukdf.west); 
\node (3-usdf) [pbox,below=4pt of 3-ukdf] {\textbf{USDF} };
\node [below right] at (3-usdf.north west) {\small \color{blue}Team} ;
 \draw[pline] (2-Infra.east) -| ++(0.4,0) |- (3-usdf.west); 
\node (2-MultiExec) [pbox,below=168pt of 2-Infra] {\textbf{Multi-site \&  User Exec} };
\node [below right] at (2-MultiExec.north west) {\small \color{blue}Activity} ;
 \draw[pline] (1-DF.east) -| ++(0.4,0) |- (2-MultiExec.west); 
\node (3-Panda) [pbox,right=15mm of 2-MultiExec] {\textbf{PanDA} };
\node [below right] at (3-Panda.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-MultiExec.east) -| ++(0.4,0) |- (3-Panda.west); 
\node (3-ubatch) [pbox,below=4pt of 3-Panda] {\textbf{User Batch} };
\node [below right] at (3-ubatch.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-MultiExec.east) -| ++(0.4,0) |- (3-ubatch.west); 
\node (1-DP) [pbox,below=496pt of 1-DF] {\textbf{Data Production} };
\node [below right] at (1-DP.north west) {\small \color{blue}Group} ;
 \draw[pline] (0-DM.east) -| ++(0.4,0) |- (1-DP.west); 
\node (2-Camp) [pbox,right=15mm of 1-DP] {\textbf{Campaign Management} };
\node [below right] at (2-Camp.north west) {\small \color{blue}Team} ;
 \draw[pline] (1-DP.east) -| ++(0.4,0) |- (2-Camp.west); 
\node (2-SciPip) [pbox,below=4pt of 2-Camp] {\textbf{Algorithms \&  Pipelines} };
\node [below right] at (2-SciPip.north west) {\small \color{blue}Team} ;
 \draw[pline] (1-DP.east) -| ++(0.4,0) |- (2-SciPip.west); 
\node (1-DS) [pbox,below=45pt of 1-DP] {\textbf{Data Services} };
\node [below right] at (1-DS.north west) {\small \color{blue}Group} ;
 \draw[pline] (0-DM.east) -| ++(0.4,0) |- (1-DS.west); 
\node (2-CompDb) [pbox,right=15mm of 1-DS] {\textbf{Complex. DB} };
\node [below right] at (2-CompDb.north west) {\small \color{blue}Team} ;
 \draw[pline] (1-DS.east) -| ++(0.4,0) |- (2-CompDb.west); 
\node (3-BigDB) [pbox,right=15mm of 2-CompDb] {\textbf{Big Databases} };
\node [below right] at (3-BigDB.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-CompDb.east) -| ++(0.4,0) |- (3-BigDB.west); 
\node (3-uDB) [pbox,below=4pt of 3-BigDB] {\textbf{User Databases} };
\node [below right] at (3-uDB.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-CompDb.east) -| ++(0.4,0) |- (3-uDB.west); 
\node (2-Portal) [pbox,below=45pt of 2-CompDb] {\textbf{RSP Portal} };
\node [below right] at (2-Portal.north west) {\small \color{blue}Product} ;
 \draw[pline] (1-DS.east) -| ++(0.4,0) |- (2-Portal.west); 
\node (2-SQuaRE) [pbox,below=4pt of 2-Portal] {\textbf{SQuaRE} };
\node [below right] at (2-SQuaRE.north west) {\small \color{blue}Team} ;
 \draw[pline] (1-DS.east) -| ++(0.4,0) |- (2-SQuaRE.west); 
\node (3-Doc) [pbox,right=15mm of 2-SQuaRE] {\textbf{Doc Services} };
\node [below right] at (3-Doc.north west) {\small \color{blue}Activity} ;
 \draw[pline] (2-SQuaRE.east) -| ++(0.4,0) |- (3-Doc.west); 
\node (3-Phal) [pbox,below=4pt of 3-Doc] {\textbf{Phalanx} };
\node [below right] at (3-Phal.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-SQuaRE.east) -| ++(0.4,0) |- (3-Phal.west); 
\node (3-RSP) [pbox,below=4pt of 3-Phal] {\textbf{RSP} };
\node [below right] at (3-RSP.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-SQuaRE.east) -| ++(0.4,0) |- (3-RSP.west); 
\node (3-Sasq) [pbox,below=4pt of 3-RSP] {\textbf{Sasquatch} };
\node [below right] at (3-Sasq.north west) {\small \color{blue}Product} ;
 \draw[pline] (2-SQuaRE.east) -| ++(0.4,0) |- (3-Sasq.west); 
\end{tikzpicture}
\end{document}
